!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{Cwg5:function(r,i,n){"use strict";n.r(i),n.d(i,"CalculationsModule",(function(){return w}));var o=n("PCNd"),c=n("tyNb"),b=n("3Pt+"),u=n("pLZG"),a=n("lJxs"),l=n("1G5W"),d=n("XNiG"),s=n("UYTb"),f=n("ceTk"),m=n("fXoL"),p=n("Vkwi"),v=n("ofXK");function h(e,t){if(1&e&&(m.Mb(0,"option",34),m.cc(1),m.Lb()),2&e){var r=t.$implicit;m.Wb("value",r.value)("title",r.display),m.xb(1),m.ec(" ",r.display," ")}}function y(e,t){if(1&e&&(m.Mb(0,"option",34),m.cc(1),m.Lb()),2&e){var r=t.$implicit;m.Wb("value",r.value)("title",r.display),m.xb(1),m.ec(" ",r.display," ")}}function L(e,t){if(1&e){var r=m.Nb();m.Kb(0),m.Mb(1,"tr",23),m.Mb(2,"th",24),m.cc(3),m.Lb(),m.Mb(4,"td",9),m.Ib(5,"input",25),m.Lb(),m.Mb(6,"td",9),m.Ib(7,"input",26),m.Lb(),m.Mb(8,"td",9),m.Mb(9,"select",27),m.bc(10,h,2,3,"option",28),m.Lb(),m.Lb(),m.Mb(11,"td",9),m.Ib(12,"input",29),m.Lb(),m.Mb(13,"td",9),m.Mb(14,"select",30),m.bc(15,y,2,3,"option",28),m.Lb(),m.Lb(),m.Mb(16,"td",9),m.Ib(17,"input",31),m.Lb(),m.Mb(18,"td",9),m.Ib(19,"input",32),m.Lb(),m.Mb(20,"td",10),m.Mb(21,"button",33),m.Tb("click",(function(){m.Yb(r);var e=t.index;return m.Vb().remove(e)})),m.cc(22,"\u0418\u0437\u0431\u0440\u0438\u0448\u0438 "),m.Lb(),m.Lb(),m.Lb(),m.Jb()}if(2&e){var i=t.$implicit,n=t.index,o=m.Vb();m.xb(1),m.Wb("formGroup",i),m.xb(2),m.dc(n+1),m.xb(7),m.Wb("ngForOf",o.measureAndAmount),m.xb(5),m.Wb("ngForOf",o.ddvRate),m.xb(2),m.Wb("value",i.get("priceBeforeTax").value*i.get("totalRequired").value),m.xb(2),m.Wb("value",i.get("priceBeforeTax").value*i.get("totalRequired").value*i.get("ddvRate").value)}}var g,M,k,I=[{path:"",component:(g=function(){function r(t,i){e(this,r),this.formBuilder=t,this.sessionStorage=i,this.destroy$=new d.a,this.measureAndAmount=[{display:"\u041a\u0438\u043b\u043e\u0433\u0440\u0430\u043c",value:"kg"},{display:"\u041b\u0438\u0442\u0430\u0440",value:"lt"},{display:"\u0411\u0440\u043e\u0458",value:"br"}],this.ddvRate=[{display:"5%",value:.05},{display:"18%",value:.18}],this.result={priceBeforeDDV:0,priceAfterDDV:0};var n=this.sessionStorage.getItemSync("calculation-form"),o=n&&n.items?this.getNewFormArray(n.items):new b.c([this.getNewItemControl(null)]);n&&n.items&&(this.result=this.calculateResult(n.items)),this.dynamicForm=this.formBuilder.group({items:o}),this.formEndResult=this.formBuilder.group({priceAfterLicitation:[null]})}var i,n,o;return i=r,(n=[{key:"ngOnInit",value:function(){var e=this;this.dynamicForm.valueChanges.pipe(Object(u.a)((function(){return e.dynamicForm.valid})),Object(a.a)((function(t){return e.calculateResult(t.items)})),Object(l.a)(this.destroy$)).subscribe((function(t){e.result=t}))}},{key:"calculateResult",value:function(e){var t=this,r={priceBeforeDDV:0,priceAfterDDV:0};return e.map((function(e){var i=t.calculateSingle(e);r.priceAfterDDV+=i.priceAfterDDV,r.priceBeforeDDV+=i.priceBeforeDDV})),r}},{key:"calculateSingle",value:function(e){var t=e.priceBeforeTax*e.totalRequired;return{priceBeforeDDV:t,priceAfterDDV:t*e.ddvRate}}},{key:"getNewFormArray",value:function(e){var t=this;return new b.c(e.map((function(e){return t.getNewItemControl(e)})))}},{key:"getNewItemControl",value:function(e){return this.formBuilder.group(e?{subject:[e.subject],priceBeforeTax:[e.priceBeforeTax,b.o.required],measureAndAmount:[e.measureAndAmount,b.o.required],ddvRate:[e.ddvRate,b.o.required],totalRequired:[e.totalRequired,b.o.required]}:{subject:[""],priceBeforeTax:[null,b.o.required],measureAndAmount:["kg",b.o.required],ddvRate:[.05,b.o.required],totalRequired:[null,b.o.required]})}},{key:"remove",value:function(e){this.items.removeAt(e)}},{key:"addNewItem",value:function(){this.items.push(this.getNewItemControl(null))}},{key:"priceAfterLicitation",value:function(){var e=this,t=this.calculateReducerPercent(this.formEndResult.get("priceAfterLicitation").value);this.items.controls.forEach((function(r){var i=e.calculateReducedValue(r.get("priceBeforeTax").value,t);r.get("priceBeforeTax").patchValue(i)}))}},{key:"calculateReducerPercent",value:function(e){return(this.result.priceBeforeDDV-e)/this.result.priceBeforeDDV}},{key:"calculateReducedValue",value:function(e,t){return e-e*t}},{key:"onSubmit",value:function(){this.dynamicForm.invalid||alert("SUCCESS!! :-)\n\n"+JSON.stringify(this.dynamicForm.value,null,4))}},{key:"submitEndResult",value:function(){this.formEndResult.invalid||alert("SUCCESS!! :-)\n\n"+JSON.stringify(this.formEndResult.value,null,4))}},{key:"onReset",value:function(){this.dynamicForm.reset(),this.items.clear()}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete()}},{key:"formItems",get:function(){return this.dynamicForm.controls}},{key:"items",get:function(){return this.formItems.items}}])&&t(i.prototype,n),o&&t(i,o),r}(),g.\u0275fac=function(e){return new(e||g)(m.Hb(b.d),m.Hb(f.a))},g.\u0275cmp=m.Bb({type:g,selectors:[["app-calculations"]],features:[m.wb([{provide:s.a,useClass:f.a}])],decls:90,vars:7,consts:[["name","calculation",3,"formGroup","ngSubmit"],[1,"card","m-3"],[1,"card-header"],[1,"table","table-hover"],[1,"bg-info"],["scope","col"],["scope","col",1,"btn-action"],[4,"ngFor","ngForOf"],[1,"list-group","list-group-flush"],[1,"align-middle"],[1,"align-middle","btn-action"],["colspan","2",1,"align-middle"],[1,"card-footer","text-center"],["type","button",1,"btn","btn-success",3,"disabled","click"],["type","reset",1,"btn","btn-warning",3,"click"],[1,"container"],[1,"row"],[1,"col-md-6"],["name","final-licitation",1,"example-form",3,"formGroup","ngSubmit"],[1,"form-group"],["for","priceAfterLicitation"],["id","priceAfterLicitation","type","number","formControlName","priceAfterLicitation","placeholder","\u0432\u043a\u0443\u043f\u043d\u0430 \u0446\u0435\u043d\u0430 \u0431\u0435\u0437 \u0434\u0434\u0432","title","\u0412\u043a\u0443\u043f\u043d\u0430\u0442\u0430 \u0446\u0435\u043d\u0430 \u043d\u0430 \u0441\u0442\u0430\u0432\u043a\u0430\u0442\u0430 \u0431\u0435\u0437 \u0432\u043a\u043b\u0443\u0447\u0435\u043d\u043e \u0434\u0434\u0432",1,"form-control"],["type","button",1,"btn","btn-success",3,"click"],[1,"bg-primary",3,"formGroup"],["scope","row"],["type","text","formControlName","subject","title","\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u043d\u0430 \u043d\u0430\u0431\u0430\u0432\u043a\u0430\u0442\u0430 \u043e\u0434\u043d\u043e\u0441\u043d\u043e \u043e\u043f\u0438\u0441 \u043d\u0430 \u0441\u0442\u043e\u043a\u0430\u0442\u0430 \u043a\u043e\u0458\u0430 \u0441\u0435 \u043f\u043e\u0431\u0430\u0440\u0443\u0432\u0430 \u0438 \u043c\u043e\u0436\u0435\u0431\u0438 \u0441\u043e\u0441\u0442\u0430\u0432\u0438 \u0438\u043b\u0438 \u0433\u0440\u0430\u043c\u0430\u0436\u0430","placeholder","\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u043d\u0430 \u043d\u0430\u0431\u0430\u0432\u043a\u0430",1,"form-control"],["type","number","formControlName","totalRequired","placeholder","\u0432\u043a\u0443\u043f\u043d\u0430 \u043f\u043e\u0431\u0430\u0440\u0430\u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0438\u043d\u0430 \u043e\u0434 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434","title","\u0432\u043a\u0443\u043f\u043d\u0430 \u043f\u043e\u0431\u0430\u0440\u0430\u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0438\u043d\u0430 \u043e\u0434 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434.\u041f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430 \u043b\u0438\u0442\u0430\u0440 \u041c\u043b\u0435\u043a\u043e \u0441\u0435 \u043f\u0438\u0448\u0443\u0432\u0430 60 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0441\u043a\u0438 \u0441\u0435 \u043f\u0440\u0435\u0441\u043c\u0435\u0442\u0443\u0432\u0430 \u0432\u043e \u043b\u0438\u0442\u0440\u0438","onkeydown","return event.keyCode !== 69","required","",1,"form-control"],["id","measureAndAmount","title","\u0415\u0434\u0438\u043d\u0435\u0447\u043d\u0430 \u043c\u0435\u0440\u043a\u0430 \u0438 \u043a\u043e\u0447\u0438\u043d\u0430 \u043d\u0430 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u043e\u0442 , \u043d\u0430 \u043f\u0440\u0438\u043c\u0435\u0440 \u043c\u043e\u0436\u0435 \u0434\u0430 \u0431\u0438\u0434\u0435 \u043a\u0438\u043b\u043e\u0433\u0440\u0430\u043c \u201e\u043a\u0433\u201c , \u043b\u0438\u0442\u0430\u0440 \u201e\u043b\u0442\u201c \u0438 \u0431\u0440\u043e\u0458 \u201e\u0431\u0440\u201c ","formControlName","measureAndAmount","required","",1,"form-control"],["class","align-center",3,"value","title",4,"ngFor","ngForOf"],["type","number","title","\u0426\u0435\u043d\u0430 \u043f\u043e \u0435\u0434\u0438\u043d\u0438\u0446\u0430 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434 - \u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u043e\u043b\u043a\u0443 \u0435 \u0446\u0435\u043d\u0430\u0442\u0430 \u043d\u0430 \u041b\u0438\u0442\u0430\u0440 \u041c\u043b\u0435\u043a\u043e , \u0438\u043b\u0438 \u043a\u0438\u043b\u043e\u0433\u0440\u0430\u043c \u0458\u0430\u0431\u043e\u043b\u043a\u0430","formControlName","priceBeforeTax","placeholder","\u0435\u0434\u0438\u043d\u0435\u0447\u043d\u0430 \u0446\u0435\u043d\u0430 \u0446\u0435\u0437 \u0434\u0434\u0432","onkeydown","return event.keyCode !== 69","required","",1,"form-control"],["id","ddvRate","title","\u0421\u0442\u0430\u043f\u043a\u0430\u0442\u0430 \u043d\u0430 \u0434\u0434\u0432 \u043f\u043e \u043a\u043e\u0458\u0430 \u0442\u0440\u0435\u0431\u0430 \u0434\u0430 \u0441\u0435 \u043f\u0440\u0435\u0441\u043c\u0435\u0442\u0430 \u043e\u0432\u043e\u0458 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434","formControlName","ddvRate","required","",1,"form-control"],["type","number","placeholder","\u0432\u043a\u0443\u043f\u043d\u0430 \u0446\u0435\u043d\u0430 \u0431\u0435\u0437 \u0434\u0434\u0432","disabled","","title","\u0412\u043a\u0443\u043f\u043d\u0430\u0442\u0430 \u0446\u0435\u043d\u0430 \u043d\u0430 \u0441\u0442\u0430\u0432\u043a\u0430\u0442\u0430 \u0431\u0435\u0437 \u0432\u043a\u043b\u0443\u0447\u0435\u043d\u043e \u0434\u0434\u0432",1,"form-control",3,"value"],["type","number","placeholder","\u0432\u043a\u0443\u043f\u043do \u0434\u0434\u0432","disabled","","title","\u0412\u043a\u0443\u043f\u043d\u043e \u0434\u0434\u0432",1,"form-control",3,"value"],["type","button",1,"btn","btn-danger",3,"click"],[1,"align-center",3,"value","title"]],template:function(e,t){1&e&&(m.Mb(0,"form",0),m.Tb("ngSubmit",(function(){return t.onSubmit()})),m.Mb(1,"div",1),m.Mb(2,"h5",2),m.cc(3,"\u041f\u0440\u0438\u043c\u0435\u0440 \u043f\u0440\u0435\u0441\u043c\u0435\u0442\u043a\u0430"),m.Lb(),m.Mb(4,"table",3),m.Mb(5,"thead"),m.Mb(6,"tr",4),m.Ib(7,"th",5),m.Mb(8,"th",5),m.cc(9,"1"),m.Lb(),m.Mb(10,"th",5),m.cc(11,"2"),m.Lb(),m.Mb(12,"th",5),m.cc(13,"3"),m.Lb(),m.Mb(14,"th",5),m.cc(15,"4"),m.Lb(),m.Mb(16,"th",5),m.cc(17,"5"),m.Lb(),m.Mb(18,"th",5),m.cc(19,"6"),m.Lb(),m.Mb(20,"th",5),m.cc(21,"7"),m.Lb(),m.Ib(22,"th",6),m.Lb(),m.Mb(23,"tr",4),m.Mb(24,"th",5),m.cc(25,"#"),m.Lb(),m.Mb(26,"th",5),m.cc(27,"\u0412\u0438\u0434 \u0438 \u043e\u043f\u0438\u0441 \u043d\u0430 \u0441\u0442\u043e\u043a\u0430"),m.Lb(),m.Mb(28,"th",5),m.cc(29,"\u0432\u043a\u0443\u043f\u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0438\u043d\u0430 \u043f\u043e \u0415\u0434\u0438\u043d.\u041c\u0435\u0440\u043a\u0430"),m.Lb(),m.Mb(30,"th",5),m.cc(31,"\u0415\u0434\u0438\u043d.\u041c\u0435\u0440\u043a\u0430 \u0438 \u043a\u043e\u043b\u0438\u0447\u0438\u043d\u0430 "),m.Lb(),m.Mb(32,"th",5),m.cc(33,"\u0415\u0434\u0438\u043d\u0435\u0447\u043d\u0430 \u0426\u0435\u043d\u0430 \u0431\u0435\u0437 \u0434\u0434\u0432."),m.Lb(),m.Mb(34,"th",5),m.cc(35,"\u0441\u0442\u0430\u043f\u043a\u0430 \u043d\u0430 \u0434\u0434\u0432 (5%/18%)"),m.Lb(),m.Mb(36,"th",5),m.cc(37,"\u0412\u043a\u0443\u043f\u043d\u0430 \u0446\u0435\u043d\u0430 \u0431\u0435\u0437 \u0434\u0434\u0432"),m.Lb(),m.Mb(38,"th",5),m.cc(39,"\u0412\u043a\u0443\u043f\u043d\u043e \u0434\u0434\u0432"),m.Lb(),m.Ib(40,"th",6),m.Lb(),m.Lb(),m.Mb(41,"tbody"),m.bc(42,L,23,6,"ng-container",7),m.Mb(43,"tr",8),m.Ib(44,"td",9),m.Ib(45,"td",9),m.Ib(46,"td",9),m.Ib(47,"td",9),m.Ib(48,"td",9),m.Mb(49,"td",9),m.cc(50," \u0412\u043a\u0443\u043f\u043d\u0430 \u0446\u0435\u043d\u0430 \u0431\u0435\u0437 \u0434\u0434\u0432 "),m.Lb(),m.Ib(51,"td",10),m.Mb(52,"td",10),m.cc(53),m.Lb(),m.Lb(),m.Mb(54,"tr",8),m.Ib(55,"td",9),m.Ib(56,"td",9),m.Ib(57,"td",9),m.Ib(58,"td",9),m.Ib(59,"td",9),m.Mb(60,"td",11),m.cc(61," \u0412\u043a\u0443\u043f\u043do \u0434\u0434\u0432 "),m.Lb(),m.Mb(62,"td",10),m.cc(63),m.Lb(),m.Lb(),m.Mb(64,"tr",8),m.Ib(65,"td",9),m.Ib(66,"td",9),m.Ib(67,"td",9),m.Ib(68,"td",9),m.Ib(69,"td",9),m.Mb(70,"td",11),m.cc(71," \u0412\u043a\u0443\u043f\u043d\u0430 \u0446\u0435\u043d\u0430 \u0441\u043e \u0434\u0434\u0432 "),m.Lb(),m.Mb(72,"td",10),m.cc(73),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Mb(74,"div",12),m.Mb(75,"button",13),m.Tb("click",(function(){return t.addNewItem()})),m.cc(76,"\u0414\u043e\u0434\u0430\u0434\u0438 \u041d\u043e\u0432"),m.Lb(),m.Mb(77,"button",14),m.Tb("click",(function(){return t.onReset()})),m.cc(78,"\u0418\u0441\u0447\u0438\u0441\u0442\u0438 \u0441\u0435"),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Mb(79,"div",15),m.Mb(80,"div",16),m.Ib(81,"div",17),m.Mb(82,"div",17),m.Mb(83,"form",18),m.Tb("ngSubmit",(function(){return t.submitEndResult()})),m.Mb(84,"div",19),m.Mb(85,"label",20),m.cc(86," \u0412\u043d\u0435\u0441\u0435\u0442\u0435 \u043a\u043e\u0458\u0430 \u0435 \u0446\u0435\u043d\u0430\u0442\u0430 \u043f\u043e\u0441\u043b\u0435 \u043b\u0438\u0446\u0438\u0442\u0430\u0446\u0438\u0458\u0430\u0442\u0430 \u043e\u0434\u043d\u043e\u0441\u043d\u043e \u0458\u0430\u0432\u043d\u043e\u0442\u043e \u043d\u0430\u0434\u0434\u0430\u0432\u0430\u045a\u0435"),m.Lb(),m.Ib(87,"input",21),m.Lb(),m.Mb(88,"button",22),m.Tb("click",(function(){return t.priceAfterLicitation()})),m.cc(89,"\u041f\u0440\u0435\u0441\u043c\u0435\u0442\u0430\u0458 \u043f\u043e \u043a\u0440\u0430\u0458\u043d\u0430 \u0446\u0435\u043d\u0430"),m.Lb(),m.Lb(),m.Lb(),m.Lb(),m.Lb()),2&e&&(m.Wb("formGroup",t.dynamicForm),m.xb(42),m.Wb("ngForOf",t.items.controls),m.xb(11),m.ec(" ",t.result.priceBeforeDDV," \u0414\u0435\u043d\u0430\u0440\u0438 "),m.xb(10),m.ec(" ",t.result.priceAfterDDV," \u0414\u0435\u043d\u0430\u0440\u0438 "),m.xb(10),m.ec(" ",t.result.priceAfterDDV+t.result.priceBeforeDDV," \u0414\u0435\u043d\u0430\u0440\u0438 "),m.xb(2),m.Wb("disabled",!t.dynamicForm.valid),m.xb(8),m.Wb("formGroup",t.formEndResult))},directives:[b.q,b.i,p.a,b.f,v.h,b.k,b.b,b.h,b.e,b.m,b.n,b.j,b.p],styles:["tr[_ngcontent-%COMP%]{display:table-row}"],changeDetection:0}),g)}],D=((k=function t(){e(this,t)}).\u0275mod=m.Fb({type:k}),k.\u0275inj=m.Eb({factory:function(e){return new(e||k)},imports:[[c.a.forChild(I)],c.a]}),k),w=((M=function t(){e(this,t)}).\u0275mod=m.Fb({type:M}),M.\u0275inj=m.Eb({factory:function(e){return new(e||M)},imports:[[o.a,D]]}),M)}}])}();